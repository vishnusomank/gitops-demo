---
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: ksp-bpfdoor-malware-ihck9wb
  namespace: default
spec:
  tags: ["BPF", "BPFDOOR","MALWARE"]
  message: "Alert! /dev/shm/kdmtmpflush file detected possible bpfdoor malware."
  selector:
    matchLabels:
      controller-revision-hash: db-postgresql-7ff7bbd8cf
      heritage: Helm
      release: db
      role: master
      statefulset.kubernetes.io/pod-name: db-postgresql-0
      app: postgresql
      chart: postgresql-8.6.4
  process:
    severity: 1
    matchPaths:
    - path: /dev/shm/kdmtmpflush
    - path:  /var/run/haldrund.pid
    matchPatterns:
    - pattern: dbus-daemon
    - pattern: justtryit
    - pattern: justrobot
    - pattern: justforfun
    action: Block
