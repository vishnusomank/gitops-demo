---
# KubeArmor is an open source software that enables you to protect your cloud workload at run-time.
# To learn more about KubeArmor visit:
# https://www.accuknox.com/kubearmor/

apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: ksp-block-cve-2022-0543-redis-rce-654nxyl
  namespace: default
spec:
  tags: ["Redis-Server","Debian", "CVE", "CVE-2022-0543","RCE","Lua Sandbox Escape"]
  message: Alert! Possible CVE-2022-0543 (Redis Lua Sandbox Escape) denied.  
  selector:
    matchLabels:
      app: redis
      chart: redis-10.5.7
      controller-revision-hash: cache-redis-slave-74c4658867
      release: cache
      role: slave
      statefulset.kubernetes.io/pod-name: cache-redis-slave-0
  file: 
    severity: 2
    matchPaths:
    - path: /usr/lib/x86_64-linux-gnu/liblua5.1.so.0
    matchPatterns:
    - pattern: /**/liblua*
    action: Block
  process: 
    severity: 2
    matchPatterns:
    - pattern: /**/bin/**
    action: Block
