apiVersion: cilium.io/v2
kind: CiliumNetworkPolicy
metadata:
  name: cnp-ingress-mysql-stig-v-235146-audit-unused-ports
  namespace: explorer
spec:
  description: "To block all unused ports on MySQL pod"
  endpointSelector:
    matchLabels:
      statefulset.kubernetes.io/pod-name: mysql-0
      app.kubernetes.io/instance: mysql
      app.kubernetes.io/name: mysql
      controller-revision-hash: mysql-69445b5fcd
      helm.sh/chart: mysql-9.1.5
  ingress:
    - fromEndpoints:
      - matchLabels:
          role: frontend # Change your match labels
      toPorts:
        - ports:
            - port: "3306"
        - ports:
            - port: "33060"
